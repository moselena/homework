<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

</body>
<script>
    const myButton = document.createElement('button');
    myButton.textContent = 'button';
    myButton.type = 'button';
    myButton.id = 'button';
    myButton.style.cssText = `font-size: 14px;
    text-decoration: none;
    cursor: pointer;
    display: block;
    width: 90px;
    font-weight: bold;
    margin:20px auto;
    text-align: center;
    padding: 1px 5px;
    color: #717171;
    border-radius: 4px;`;
    document.body.append(myButton);

    function createDiv() {
        let divsize = ((Math.random() * 100) + 50).toFixed();
        let color = '#' + Math.round(0xffffff * Math.random()).toString(16);
        var posx = (Math.random() * document.documentElement.clientWidth - divsize).toFixed();
        var posy = (Math.random() * document.documentElement.clientWidth - divsize).toFixed();
        let newDiv = document.createElement('div');
        newDiv.classList.add('draggable-div');
        newDiv.style.cssText = `width: ${divsize}px;
        height: ${divsize}px;
        background-color: ${color};
        position: absolute;
        left: ${posx}px;
        top: ${posy}px`;
        document.body.append(newDiv);
    };
    const elem = document.getElementById('button');
    elem.addEventListener('click', createDiv);

    document.querySelector('body').addEventListener('mousedown', (event) => {
        const { target, clientX, clientY, pageX, pageY } = event;
        const shiftX = clientX - target.getBoundingClientRect().left;
        const shiftY = clientY - target.getBoundingClientRect().top;
        target.style.zIndex = 1000;
        moveAt(pageX, pageY);

        function moveAt({ pageX, pageY }) {
            target.style.left = pageX - shiftX + 'px';
            target.style.top = pageY - shiftY + 'px';
        }

        document.addEventListener('mousemove', moveAt);
        target.onmouseup = () => {
            target.style.zIndex = 'auto';
            document.removeEventListener('mousemove', moveAt);
            target.onmouseup = null;
        };
    });
    document.body.ondragstart = () => false;
</script>

</html>